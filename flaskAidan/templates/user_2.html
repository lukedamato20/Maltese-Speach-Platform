<!DOCTYPE html>
<html>
<body>
<script src="https://d3js.org/d3.v3.min.js"></script>
<script src="https://rawgit.com/jasondavies/d3-cloud/master/build/d3.layout.cloud.js"></script>
<script>

function wordCloud(selector) {

  var fill = d3.scale.category20();

  // construct the word cloud's SVG element
  var svg = d3.select(selector).append("svg")
      .attr("width", 500)
      .attr("height", 500)
      .append("g")
      .attr("transform", "translate(250,250)");


  // drawing the word cloud
  function draw(words) {
      var cloud = svg.selectAll("g text")
                      .data(words, function(d) { return d.text; })

      // cloud for enterring words
      cloud.enter()
          .append("text")
          .style("font-family", "Times")
          .style("fill", function(d, i) { return fill(i); })
          .attr("text-anchor", "middle")
          .attr('font-size', 1)
          .text(function(d) { return d.text; });

      // implementing the transition from enterring words to exitting words
      cloud
          .transition()
              .duration(600)
              .style("font-size", function(d) { return d.size + "px"; })
              .attr("transform", function(d) {
                  return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
              })
              .style("fill-opacity", 1);

      // cloud for exitting words
      cloud.exit()
          .transition()
              .duration(200)
              .style('fill-opacity', 1e-6)
              .attr('font-size', 1)
              .remove();
  }

  return {


      update: function(words) {
          d3.layout.cloud().size([400, 400])
              .words(words)
              .padding(5)
              .rotate(function() { return ~~(Math.random() * 2) * 90; })
              .font("Times")
              .fontSize(function(d) { return d.size; })
              .on("end", draw)
              .start();
      }
  }

}

// Some emails extracated from user 2 (arnold-j-p)
var words = [
 "i think it is something we need to do.  please set it up",
 "seems crazy.  if you're willing to ride it for a few cents against you it's a  great trade.  who knows where they're going in th eshort term though",
 "who were you trying to bet on??",
 "adams bot 1/2 6365",
 "The information contained herein is based on sources that we believe to bereliable, but we do not represent that it is accurate or complete.  Nothingcontained herein should be considered as an offer to sell or a solicitationof an offer to buy any financial instruments discussed herein.  Anyopinions expressed herein are solely those of the author.  As such, they may differ in material respects from those of, or expressed or published by on behalf of Carr Futures or its officers, directors, employees or affiliates.  , 2000 Carr Futures",
 "you think that's a valid excuse?   whatever....",
 "what time did you get in?",
 "how bout today at 400",
 "Attached is an invitation from the IDRC Houston Chapter.",
 "So my point shown a little bit right now..  Weather a little cooler for this  week.  Overall normal for 6-10.  JV up 12 cents.  Think just as customers got  totally fucked last year selling into the rally, they are going to buy all  the way down.  Differnence is last year trade very happy to take in all the  length.  This year trade not ready to get really short.  Not until healthy  inj in April anyways.   I think money from here will be made being short,  just question of what and when.  Think there'll be enough hedging demand to  keep curve very strong unless phys market just totally rejects price level.    With amount of in capacity available, hard to believe phys market is going ",
 "Just a reminder about drinks Monday night.."
]

// removing symbols and returning words randomly using math.random
function getWords(i) {
  return words[i]
          .replace(/[!\.,:;\?]/g, '')
          .split(' ')
          .map(function(d) {
              return {text: d, size: 10 + Math.random() * 60};
          })
}

// showing new words after removing symbols from getWords function
function showNewWords(vis, i) {
  i = i || 0;

  vis.update(getWords(i ++ % words.length))
  setTimeout(function() { showNewWords(vis, i + 1)}, 2000)
}

var myWordCloud = wordCloud('body');

// iterating through each word
showNewWords(myWordCloud);

</script>
</body>
</html>